<!DOCTYPE HTML>

<html lang='en'>
	<head>
		<title>goswaggerå…¥é—¨æ‰‹å†Œ &middot; Yeqown</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		
		
		
		<link rel="stylesheet" href="/assets/css/main.min.css">
		
		
		<link rel="shortcut icon" href="favicon.ico">
		
		
		<noscript><link rel="stylesheet" href='/assets/css/noscript.css' /></noscript>
		<link rel="stylesheet" href="/highlight/styles/monokai-sublime.css">
		
		<script src="/highlight/highlight.pack.js"></script>
		<script>hljs.initHighlightingOnLoad();</script>
	</head>
	<body lang='en' class="is-preload">

		
			<div id="wrapper">

                
<header id="header">
    <a href='/' class="logo">Yeqown</a>
</header>

                

<nav id="nav">
    <ul class="links">
        <li class="active"><a href='/'>Yeqown</a></li>
        
        <li><a href='/#footer'>Contact</a></li>
        
        
    </ul>
    
    <ul class="icons">
        
        <li><a href="https://twitter.com/yeqown" class="icon fa-twitter"><span class="label">Twitter</span></a></li>
        
        
        
        
        
        <li><a href="https://github.com/yeqown" class="icon fa-github"><span class="label">GitHub</span></a></li>
        
        
        
        
        
    </ul>
    
</nav>


				
					<div id="main">

						
                        <section class="post">
                            <header class="major">
                                
                                <span class="date">March 30, 2019</span>
                                
                                <h1>goswaggerå…¥é—¨æ‰‹å†Œ</h1>
                                <p>æœ¬æ–‡æ—¨åœ¨è®°å½•ä½¿ç”¨goswaggerè¿‡ç¨‹ä¸­é‡åˆ°çš„ä¸€äº›é—®é¢˜ï¼ˆåªåœ¨ç”Ÿæˆæ–‡æ¡£æ–¹é¢ï¼Œä¸æ¶‰åŠå…¶ä»–åŠŸèƒ½ï¼‰ã€‚</p>
                            </header>
                            
                            <blockquote>
<p>æœ¬æ–‡æ—¨åœ¨è®°å½•ä½¿ç”¨goswaggerè¿‡ç¨‹ä¸­é‡åˆ°çš„ä¸€äº›é—®é¢˜ï¼ˆåªåœ¨ç”Ÿæˆæ–‡æ¡£æ–¹é¢ï¼Œä¸æ¶‰åŠå…¶ä»–åŠŸèƒ½ï¼‰ï¼š</p>
</blockquote>
<ul>
<li>å¦‚ä½•åœ¨go1.11+ä»¥ä¸Šï¼ˆæ”¯æŒGo Moduleï¼‰ç‰ˆæœ¬ä¸­çš„åº”ç”¨swagger</li>
<li>ä¸€äº›æ³¨è§£ä¸Šçš„æ³¨æ„äº‹é¡¹</li>
<li>å¦‚ä½•åœ¨å›¢é˜Ÿä¸­ç®¡ç†APIæ–‡æ¡£ï¼ˆä¸»è¦æ¶µç›–äº†ï¼šswagger-uiçš„éƒ¨ç½²å’Œä½¿ç”¨ï¼‰</li>
</ul>
<h3 id="å…³äºswaggerhttpsswaggerio">å…³äº<a href="https://swagger.io">swagger</a></h3>
<p>swaggeræ¶µç›–WebAPIçš„ä¸€æ•´å¥—å·¥å…·ï¼šAPIè®¾è®¡ï¼ŒAPIå®ç°ï¼ˆä»£ç ç”Ÿæˆï¼‰ï¼ŒAPIæ–‡æ¡£ï¼ŒAPIæµ‹è¯•åŠAPIè§„èŒƒã€‚æ›´å¤šä¿¡æ¯è¯·å‚è§å®˜ç½‘</p>
<!-- more -->
<h3 id="å‡†å¤‡å·¥ä½œ">å‡†å¤‡å·¥ä½œ</h3>
<ul>
<li>ä¸€ä¸ªGolang webé¡¹ç›®ï¼Œå¹¶è½¯è¿æ¥åˆ°<code>GOPATH/src</code>ä¸‹ã€‚ã€æ¯•ç«Ÿæ˜¯æ”¯æŒGomoduleçš„é¡¹ç›®ï¼Œè¿˜æ”¾åœ¨GOPATHä¸‹å°±ä¸ç§‘å­¦äº†ğŸ˜„ã€‘</li>
<li>å®‰è£…swaggerå·¥å…·. å‚è§<a href="https://goswagger.io/install.html">å®‰è£…</a></li>
<li>ç¯å¢ƒï¼š
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">âœ  swagger-demo git:<span style="color:#f92672">(</span>master<span style="color:#f92672">)</span> âœ— go version
go version go1.11.5 darwin/amd64
âœ  swagger-demo git:<span style="color:#f92672">(</span>master<span style="color:#f92672">)</span> âœ— swagger version
version: v0.18.0
commit: 6b23bb61413826ce42c3b14a37bf5870caf91e0b
</code></pre></div></li>
</ul>
<h3 id="ç¼–å†™æ³¨é‡Š">ç¼–å†™æ³¨é‡Š</h3>
<blockquote>
<p>å…ƒä¿¡æ¯åŒ…å«äº†è¿™ä¸ªåº”ç”¨çš„åŸºæœ¬ä¿¡æ¯ã€‚ä¸€èˆ¬æ–°å»ºä¸€ä¸ªdoc.goæ”¾åœ¨ä½ çš„APIæ ¹ç›®å½•ä¸‹ï¼›è¿˜æœ‰ä¸€å®šè¦æ³¨æ„è¿™å¥è¯ï¼š</p>
</blockquote>
<blockquote>
<p>You give it a main file and it will parse all the files that are reachable by that main package to produce a swagger specification.To use you can add a go:generate comment to your main fileã€‚</p>
</blockquote>
<blockquote>
<p>//go:generate swagger generate spec</p>
</blockquote>
<blockquote>
<p>The command requires a main package or file and it wants your code to compile. It uses the go tools loader to load an application and then scans all the packages that are in use by the code base. This means that for something to be discoverable it needs to be reachable by a code path triggered through the main package.</p>
</blockquote>
<blockquote>
<p>å°±æ˜¯è¯´å¦‚æœä½ é…ç½®å¥½äº†ä¸€åˆ‡ä¸œè¥¿ï¼Œä½†æ˜¯å´å› ä¸ºä½ çš„mainåŒ…â€œèŠ±é‡Œèƒ¡å“¨â€ï¼Œè€Œæ— æ³•ç”Ÿæˆæ–‡æ¡£çš„æ—¶å€™ï¼Œè®°å¾—å°è¯•ä¸‹è¿™ä¸ªæ–¹æ³•ï¼ï¼ï¼</p>
</blockquote>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œä¸€ä¸ªAPIçš„æ–‡æ¡£æ— éåŒ…æ‹¬ï¼šè¯·æ±‚æ–¹æ³•ï¼Œè·¯ç”±ï¼Œå‚æ•°ï¼Œå“åº”ã€‚å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#75715e">// æ ¼å¼ï¼šswagger:parameters æ“ä½œID(ä¹Ÿå°±æ˜¯æ ‡ç¤ºä¸€ä¸ªè·¯ç”±çš„ID)
</span><span style="color:#75715e">// swagger:parameters opid-get
</span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">getForm</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#75715e">// in: query
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">ID</span> <span style="color:#66d9ef">int</span> <span style="color:#e6db74">`form:&#34;id&#34; binding:&#34;required&#34;`</span>
}

<span style="color:#75715e">// æ ¼å¼ï¼šswagger:model ?æ¨¡å‹å(å¯é€‰)
</span><span style="color:#75715e">// åŠ¨æ‰‹é¢˜ï¼šä¸ºä»€ä¹ˆè¿˜éœ€è¦é¢å¤–å®šä¹‰ä¸€ä¸ªæ¨¡å‹getmodelsæ¥ä½¿ç”¨ï¼Ÿè€Œä¸æ˜¯ç›´æ¥åœ¨getResponseä¸­ä½¿ç”¨ []*models.GetModel ?
</span><span style="color:#75715e">// swagger:model
</span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">getmodels</span> []<span style="color:#f92672">*</span><span style="color:#a6e22e">models</span>.<span style="color:#a6e22e">GetModel</span>

<span style="color:#75715e">// æ ¼å¼ï¼šswagger:response å“åº”ç»“æ„å
</span><span style="color:#75715e">// getResponse response demo of get controller
</span><span style="color:#75715e">// swagger:response getResponse
</span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">getResponse</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#75715e">// code intï¼Œè¿™é‡Œå‚æ•°è¾ƒå¤šè‡ªè¡Œå‚ç…§æ–‡æ¡£ï¼Œä¸ªäººè§‰å¾—æ¯”è¾ƒå®ç”¨çš„æ˜¯ â€œin: query|bodyâ€ ç”¨äºè¯´æ˜å‚æ•°å­˜åœ¨çš„ä½ç½®
</span><span style="color:#75715e"></span>	<span style="color:#75715e">// in: body
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">Code</span> <span style="color:#66d9ef">int</span> <span style="color:#e6db74">`json:&#34;code&#34;`</span>
	<span style="color:#75715e">// modesl getmodel
</span><span style="color:#75715e"></span>	<span style="color:#75715e">// in: body
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">Models</span> <span style="color:#a6e22e">getmodels</span> <span style="color:#e6db74">`json:&#34;models&#34;`</span>
}

<span style="color:#75715e">// Get ...
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">Get</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gin</span>.<span style="color:#a6e22e">Context</span>) {
	<span style="color:#75715e">// swagger:route GET /base/get èŒƒä¾‹ opid-get
</span><span style="color:#75715e"></span>	<span style="color:#75715e">//
</span><span style="color:#75715e"></span>	<span style="color:#75715e">// swagger GetèŒƒä¾‹
</span><span style="color:#75715e"></span>	<span style="color:#75715e">//
</span><span style="color:#75715e"></span>	<span style="color:#75715e">//
</span><span style="color:#75715e"></span>	<span style="color:#75715e">//     Consumes:
</span><span style="color:#75715e"></span>	<span style="color:#75715e">//     - application/json
</span><span style="color:#75715e"></span>	<span style="color:#75715e">//     - application/x-protobuf
</span><span style="color:#75715e"></span>	<span style="color:#75715e">//
</span><span style="color:#75715e"></span>	<span style="color:#75715e">//     Produces:
</span><span style="color:#75715e"></span>	<span style="color:#75715e">//     - application/json
</span><span style="color:#75715e"></span>	<span style="color:#75715e">//     - application/x-protobuf
</span><span style="color:#75715e"></span>	<span style="color:#75715e">//
</span><span style="color:#75715e"></span>	<span style="color:#75715e">//     Schemes: http, https, ws, wss
</span><span style="color:#75715e"></span>	<span style="color:#75715e">//
</span><span style="color:#75715e"></span>	<span style="color:#75715e">//     Responses:
</span><span style="color:#75715e"></span>	<span style="color:#75715e">//       default: getResponse
</span><span style="color:#75715e"></span>	<span style="color:#66d9ef">var</span> (
		<span style="color:#a6e22e">form</span> = new(<span style="color:#a6e22e">getForm</span>)
		<span style="color:#a6e22e">resp</span> = new(<span style="color:#a6e22e">getResponse</span>)
	)

	<span style="color:#a6e22e">resp</span>.<span style="color:#a6e22e">Code</span> = <span style="color:#ae81ff">0</span>
	<span style="color:#a6e22e">resp</span>.<span style="color:#a6e22e">Models</span> = <span style="color:#a6e22e">services</span>.<span style="color:#a6e22e">ListGetModels</span>()

	<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;form is :&#34;</span>, <span style="color:#f92672">*</span><span style="color:#a6e22e">form</span>)
	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#a6e22e">resp</span>)
}
</code></pre></div><p>ä¸Šè¿°åªæ˜¯æœ€åŸºæœ¬çš„å…³äºä¸€ä¸ªAPIçš„åŸºç¡€æ³¨é‡Šã€‚æ›´å¤šè¯·å‚è§å®˜æ–¹æ–‡æ¡£ï¼Œå°½ç®¡å®ƒä¸ä¸€å®šæ˜¯æœ€æ–°çš„ï½</p>
<h3 id="ç”Ÿæˆapiæ–‡æ¡£swaggerjson">ç”ŸæˆAPIæ–‡æ¡£ï¼ˆswagger.jsonï¼‰</h3>
<p>swagger ç”Ÿæˆæ–‡æ¡£çš„å‘½ä»¤å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">âœ  gonic git:<span style="color:#f92672">(</span>master<span style="color:#f92672">)</span> âœ— swagger generate spec -h
Usage:
  swagger <span style="color:#f92672">[</span>OPTIONS<span style="color:#f92672">]</span> generate spec <span style="color:#f92672">[</span>spec-OPTIONS<span style="color:#f92672">]</span>

generate a swagger spec document from a go application

Application Options:
  -q, --quiet               silence logs
  -o, --output<span style="color:#f92672">=</span>LOG-FILE     redirect logs to file

Help Options:
  -h, --help                Show this help message

<span style="color:#f92672">[</span>spec command options<span style="color:#f92672">]</span>
      -b, --base-path<span style="color:#f92672">=</span>      the base path to use <span style="color:#f92672">(</span>default: .<span style="color:#f92672">)</span>
      -t, --tags<span style="color:#f92672">=</span>           build tags
      -m, --scan-models     includes models that were annotated with <span style="color:#e6db74">&#39;swagger:model&#39;</span>
          --compact         when present, doesn<span style="color:#960050;background-color:#1e0010">&#39;</span>t prettify the json
      -o, --output<span style="color:#f92672">=</span>         the file to write to
      -i, --input<span style="color:#f92672">=</span>          the file to use as input
      -c, --include<span style="color:#f92672">=</span>        include packages matching pattern
      -x, --exclude<span style="color:#f92672">=</span>        exclude packages matching pattern
          --include-tag<span style="color:#f92672">=</span>    include routes having specified tags <span style="color:#f92672">(</span>can be specified many times<span style="color:#f92672">)</span>
          --exclude-tag<span style="color:#f92672">=</span>    exclude routes having specified tags <span style="color:#f92672">(</span>can be specified many times<span style="color:#f92672">)</span>
</code></pre></div><p>ç”¨äºè¯´æ˜çš„Makefile</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-makefile" data-lang="makefile"><span style="color:#a6e22e">gen-doc</span><span style="color:#f92672">:</span>
	<span style="color:#75715e"># ä¸ v3æ— å¼‚ï¼Œåªæ˜¯ä¸æ ¼å¼åŒ–ç”Ÿæˆçš„jsonæ–‡ä»¶</span>
	GO111MODULE<span style="color:#f92672">=</span>off swagger generate spec -o swagger-demo.swagger.final.json -b ./mainC -c swagger-demo -m --compact

<span style="color:#a6e22e">gen-doc-v3</span><span style="color:#f92672">:</span>
	<span style="color:#75715e"># æ”¯æŒæ‰«æ swagger:model</span>
	GO111MODULE<span style="color:#f92672">=</span>off swagger generate spec -o swagger-demo.swagger.v3.json -b ./mainC -c swagger-demo -m

<span style="color:#a6e22e">gen-doc-v2</span><span style="color:#f92672">:</span>
	<span style="color:#75715e"># å¦‚æœé‡åˆ°æ‰¾ä¸åˆ°è‡ªå·±é¡¹ç›®å†…éƒ¨åŒ…çš„æƒ…å†µï¼Œä¸”mainåŒ…èŠ±é‡Œå‘¼å“¨</span>
	GO111MODULE<span style="color:#f92672">=</span>off swagger generate spec -o swagger-demo.swagger.v2.json -b ./mainC -c swagger-demo

<span style="color:#a6e22e">gen-doc-v1</span><span style="color:#f92672">:</span>
	<span style="color:#75715e"># mainåŒ…èŠ±é‡Œèƒ¡å“¨ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªå•æ–‡ä»¶</span>
	GO111MODULE<span style="color:#f92672">=</span>off swagger generate spec -o swagger-demo.swagger.v1.json -b ./mainC

<span style="color:#a6e22e">gen-doc-v0</span><span style="color:#f92672">:</span>
	<span style="color:#75715e"># å¸¸è§„ç”¨æ³•ï¼ˆé€‚ç”¨äºç¬¦åˆgoswaggeræ ‡å‡†çš„é¡¹ç›®ï¼‰</span>
	GO111MODULE<span style="color:#f92672">=</span>off swagger generate spec -o swagger-demo.swagger.v0.json

<span style="color:#a6e22e">default</span><span style="color:#f92672">:</span> gen-doc-v0 gen-doc-v1 gen-doc-v2 gen-doc-v3 gen-doc 
</code></pre></div><h3 id="ç®¡ç†apiæ–‡æ¡£">ç®¡ç†APIæ–‡æ¡£</h3>
<p>ç”Ÿæˆäº†swagger.jsonæ–‡ä»¶ä¹‹åï¼Œæ¥ä¸‹æ¥å°±ç¥­å‡ºå¯è§†åŒ–å·¥å…·äº†<code>swagger-ui</code>ã€‚å¦‚æœåªæ˜¯å°é²œï¼Œå¯ä»¥å…ˆç”¨<code>swagger-editor</code>é¢„è§ˆä¸€ä¸‹ã€‚</p>
<blockquote>
<p>è¯ä¸å¤šè¯´ï¼š swagger-uiçš„dockeré•œåƒç‰ˆï¼šè‡ªå¸¦nginxã€‚</p>
</blockquote>
<p>ç›´æ¥ä¸Šdocker-composeé…ç½®æ–‡ä»¶ï¼Œè¯­æ³•å¯èƒ½ä¸å…¼å®¹å„ä¸ªç‰ˆæœ¬ï¼Œè¯·è‡ªè¡Œè°ƒè¯•ã€‚</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yml" data-lang="yml"><span style="color:#f92672">version</span>: <span style="color:#e6db74">&#34;2&#34;</span>
<span style="color:#f92672">services</span>:
  <span style="color:#f92672">swagger_ui</span>:
    <span style="color:#f92672">environment</span>:
    - <span style="color:#ae81ff">SWAGGER_JSON=/usr/share/nginx/html/docs/swagger.json</span>
    <span style="color:#f92672">image</span>:   <span style="color:#e6db74">&#34;swaggerapi/swagger-ui&#34;</span>
    <span style="color:#f92672">volumes</span>: [<span style="color:#e6db74">&#34;./docs/:/usr/share/nginx/html/docs:rw&#34;</span>]
    <span style="color:#f92672">restart</span>: <span style="color:#ae81ff">always</span>
    <span style="color:#f92672">ports</span>:   [<span style="color:#e6db74">&#34;9000:8080&#34;</span>]
</code></pre></div><p>æŠŠå®¹å™¨è¿è¡Œèµ·æ¥åï¼Œä½ å°±å¯ä»¥åœ¨é…ç½®çš„ç«¯å£è®¿é—®åˆ°<code>swagger-ui</code>çš„ç•Œé¢äº†ï¼Œåœ¨é¡¶éƒ¨çš„æœç´¢æ ä¸­è¾“å…¥æƒ³è¦æŸ¥çœ‹çš„æ–‡æ¡£çš„URLï¼Œå°±å¯ä»¥æ–¹ä¾¿çš„æŸ¥çœ‹æ–‡æ¡£äº†ã€‚</p>
<h3 id="å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</h3>
<ul>
<li>ä»¥ä¸Šä»£ç å‡åœ¨<a href="https://github.com/yeqown/playground/tree/master/gonic/swagger-demo">yeqown/playground/gonic/swagger-demo</a>å¯ä»¥æ‰¾åˆ°</li>
<li><a href="https://swagger.io">swaggerå®˜ç½‘</a></li>
<li><a href="https://goswagger.io">goswagger.io</a></li>
</ul>


                            
                            
                            
                            
                            
                        </section>

					</div>

                    

<footer id="footer">
    
    <section>
      <form method="post" action="post-action">
        <div class="fields">
          <div class="field">
            <label for="name">Name</label>
            <input type="text" name="name" id="name" />
          </div>
          <div class="field">
            <label for="email">Email</label>
            <input type="text" name="email" id="email" />
          </div>
          <div class="field">
            <label for="message">Message</label>
            <textarea name="message" id="message" rows="3"></textarea>
          </div>
        </div>
        <ul class="actions">
          <li><input type="submit" value='Send A Message' /></li>
        </ul>
      </form>
    </section>
    
    <section class="split contact">
        
        <section class="alt">
            <h3>Address</h3>
            <p>
                
                     Chengdu Â· China
                
                     <br/>  This is a city that comes and doesn&#39;t want to go
                
            </p>
        </section>
        
        
        <section>
            <h3>Phone</h3>
            <p><a href="tel:no%20way">no way</a></p>
        </section>
        
        
        <section>
            <h3>Email</h3>
            <p><a href="mailto:yeqown@gmail.com">yeqown@gmail.com</a></p>
        </section>
        
        
        <section>
            <h3>Social</h3>
            <ul class="icons alt">
                
                <li><a href="https://twitter.com/yeqown" class="icon alt fa-twitter"><span class="label">Twitter</span></a></li>
                
                
                
                
                
                <li><a href="https://github.com/yeqown" class="icon alt fa-github"><span class="label">GitHub</span></a></li>
                
                
                
                
                
            </ul>
        </section>
        
    </section>
</footer>

                    
<div id="copyright">
    <ul><li>&copy; Yeqown</li><li>Design: <a href="https://html5up.net">HTML5 UP</a></li><li>Hugo Port: <a href="https://curtistimson.co.uk">curttimson</a></li></ul>
</div>


            </div>
            
            










<script src='/assets/js/bundle.js'></script>
	</body>
</html>
